<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- gsap  -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script> -->
    <!-- Micron Js -->
    <!-- <link
      href="https://unpkg.com/webkul-micron@1.1.6/dist/css/micron.min.css"
      type="text/css"
      rel="stylesheet"
    /> -->
    <!-- pixi -->
    <!-- <script src="https://pixijs.download/release/pixi.js"></script> -->

    <!-- css -->
    <link rel="stylesheet" href="style.css" />
    <title>Games</title>
    <!-- phaser js -->
    <script src="
https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js
"></script>

    <!-- creatjs -->
    <script src="https://code.createjs.com/1.0.0/easeljs.min.js"></script>
  </head>
  <body>
    <canvas id="canvas"> </canvas>
    <!-- <canvas id="canvasImg"> </canvas> -->
    <canvas id="canvasText"> </canvas>
    <strong id="content"></strong>
    <h1 id="words"></h1>
    <!-- <img
      id="me"
      class="box"
      src="http://o.ooli.ca/person.png"
      alt=""
      srcset=""
    /> -->
    <span id="catch">WORD :</span>

    <script>
      let canvas = document.querySelector("#canvas");
      //   let img = document.querySelector("img");
      let canvasText = document.querySelector("#canvasText");
      let width = (canvas.width = window.innerWidth);
      let height = (canvas.height = window.innerHeight);
      canvasText.height = window.innerHeight;
      canvasText.width = window.innerWidth;

      // -----Word Api------------
      let url = "https://random-word-api.herokuapp.com/all";
      let word = document.querySelector("h1");
      let catchWord = document.querySelector("#catch");
      let person = document.querySelector(".box");
      let count = 0;
      let level = 1;
      // let canvas = document.querySelector("#canvas");
      let letter = [
        "r",
        "e",
        "w",
        "q",
        "t",
        "y",
        "u",
        "i",
        "o",
        "p",
        "l",
        "k",
        "j",
        "h",
        "g",
        "f",
        "d",
        "s",
        "a",
        "z",
        "x",
        "c",
        "v",
        "b",
        "n",
        "m",
      ];
      //   canvasText.style.background = "#ff1";
      canvasText.style.zIndex = "1";

      canvas.style.background = "#ff8";
      let ctx = canvas.getContext("2d");
      let ctxText = canvasText.getContext("2d");
      // canvas.addChild(canvasImg)

      let comp = [];
      let result = [];

      // ------------------------------------------------Letters--------------------

      function isCatch() {
        let letter1 = canvas.getBoundingClientRect();
        let person1 = canvasText.getBoundingClientRect();
        if (
          !(
            person1.right < letter1.left ||
            person1.left > letter1.right ||
            person1.bottom < letter1.top ||
            person1.top > letter1.bottom
          )
        ) {
          //   if (result.includes(lette.textContent)) {
          console.log("ppppppppppppppppppppppp");
          //     let index = result.indexOf(lette.textContent);
          //     comp.splice(index, 1, lette.textContent);
          //     gsap.killTweensOf(1);
          //     person.style.position = "fixed";
          //     micron.getEle("#me").interaction("shake");
          //     // .timing("ease-out");
          //     console.log(result.findIndex(lette.textContent));
          //   } else {
          //     console.log(comp);
          //     console.log("No");
          //   }
        }
      }
      isCatch();
      // -------------------------- fetch API ------------------------

      function filter(params, number, number2 = 0) {
        return params.filter((e) => e.length < number && e.length >= number2);
      }

      async function words() {
        let data = await fetch(url);
        let res = await data.json();
        level == 1
          ? (word.innerText = filter(res, 5)[
              Math.floor(Math.random() * filter(res, 5).length)
            ])
          : level == 2
          ? filter(res, 7, 5)[Math.floor(Math.random() * filter(res, 7, 5))]
          : filter(res, 20, 7)[Math.floor(Math.random() * filter(res, 20, 7))];

        word.textContent.split("").forEach((e) => {
          result.push(e);
          comp.push("_");
        });
        //   console.log(result);
        //   console.log(comp);
        catchWord.innerText += comp.join(" ");
      }
      words();

      // ---------- move letters----------------------

      let y = 0;
      let w = Math.floor(Math.random() * width);
      let text = letter[Math.floor(Math.random() * letter.length)];
      setInterval(fall, 1000);
      function fall() {
        // ctx.beginPath();

        ctxText.clearRect(0, 0, width, height);

        ctxText.font = "80px Arial";
        ctxText.fillText(text, w, y);
        if (y <= height) {
          y += 1;

          requestAnimationFrame(fall);
        } else {
          text = letter[Math.floor(Math.random() * letter.length)];
          w = Math.floor(Math.random() * width);
          y = 0;
          ctxText.fillText(text, w, y);
        }
      }

      // ----------------- move-------------------

      let x = 1;
      img = new Image();
      img.onload = () => {
        ctx.drawImage(img, 0, height - 100);

        ctx.stroke();
      };
      img.src = "person-removebg-preview.png";

      window.addEventListener("keydown", down);
      function down(params) {
        let imgWidth = img.width;
        let imgHeight = img.height;
        console.log(imgWidth);
        console.log(imgHeight);
        console.log(canvasText.getBoundingClientRect());
        if (params.key == "ArrowRight") {
          x >= width - 100 ? (x = width - 100) : (x += 100);
          anime(x);
        } else if (params.key == "ArrowLeft") {
          x < 100 ? (x = 0) : (x -= 100);
          anime(x);
        }
      }

      function anime(v) {
        ctx.clearRect(0, 0, width, height);
        ctx.drawImage(img, v, height - 100);
      }
      //   down();
    </script>

    <!-- <script
      src="https://unpkg.com/webkul-micron@1.1.6/dist/script/micron.min.js"
      type="text/javascript"
    ></script> -->
  </body>
</html>
